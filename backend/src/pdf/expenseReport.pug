doctype html
html
  head
    style.
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
      body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        color: #333;
        font-size: 11px;
        line-height: 1.4;
      }
      .header {
        margin-bottom: 20px;
        border-bottom: 2px solid #0091ea; /* Blue line */
        padding-bottom: 10px;
      }
      .report-title {
        font-size: 20px;
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }
      .meta-info {
        font-size: 12px;
        color: #666;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        background-color: #fff;
      }
      th {
        background-color: #0288d1; /* Reference Blue */
        color: #fff;
        text-align: left;
        padding: 6px 8px;
        font-weight: 600;
        border: 1px solid #0288d1;
      }
      td {
        padding: 6px 8px;
        border: 1px solid #e0e0e0;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      .text-right {
        text-align: right;
      }
      .text-center {
        text-align: center;
      }
      .amount-cell {
        font-family: 'Courier New', Courier, monospace;
        font-weight: bold;
      }
      .total-row td {
        background-color: #e1f5fe;
        font-weight: bold;
        color: #01579b;
        border-top: 2px solid #0288d1;
      }
      .footer-section {
        position: fixed;
        bottom: 0;
        right: 0;
        width: 100%;
        text-align: center;
        font-size: 10px;
        color: #999;
        border-top: 1px solid #eee;
        padding-top: 10px;
      }

  body
    .header(style="display: flex; justify-content: space-between; align-items: center;")
      div
        if logo
          img(src=logo, style="max-height: 50px; margin-bottom: 10px;")
        .report-title Expense Report (GST)
        div(style="font-size: 10px; color: #666; margin-top: 5px")
            div #{settings.company_name}
            if settings.company_address
                div #{settings.company_address}
            div
                if settings.company_phone
                    span Phone: #{settings.company_phone} 
                if settings.company_email
                    span | Email: #{settings.company_email}
      .meta-info(style="text-align: right;")
        div Generated: #{moment().format(dateFormat)}
        if model.startDate && model.endDate
          div Period: #{model.startDate} to #{model.endDate}

    table
      thead
        tr
          th(style="width: 3%") #
          th(style="width: 8%") Date
          th(style="width: 12%") Recipient
          th(style="width: 8%") Type
          th(style="width: 20%") Description
          th(style="width: 10%; text-align:right") Base Amt
          th(style="width: 5%; text-align:center") Rate
          th(style="width: 8%; text-align:right") CGST
          th(style="width: 8%; text-align:right") SGST
          th(style="width: 8%; text-align:right") IGST
          th(style="width: 10%; text-align:right") Total
      tbody
        - let totalBase = 0
        - let totalCGST = 0
        - let totalSGST = 0
        - let totalIGST = 0
        - let totalGrand = 0
        
        each expense, index in model.items
          - totalBase += (expense.amount || 0)
          - let cgst = 0, sgst = 0, igst = 0;
          - if (expense.taxType === 'CGST_SGST') { cgst = sgst = (expense.taxAmount || 0) / 2 }
          - if (expense.taxType === 'IGST') { igst = (expense.taxAmount || 0) }
          - totalCGST += cgst
          - totalSGST += sgst
          - totalIGST += igst
          - totalGrand += (expense.totalAmount || expense.amount || 0)
          
          tr
            td.text-center #{index + 1}
            td #{moment(expense.date).format(dateFormat)}
            td 
              if expense.recipientType === 'Supplier' && expense.supplier
                | #{expense.supplier.name}
              else if expense.recipientType === 'Labour' && expense.labour
                | #{expense.labour.name}
              else
                | #{expense.otherRecipient || '-'}
            td #{expense.recipientType}
            td #{expense.description || '-'}
            td.text-right.amount-cell #{moneyFormatter({ amount: expense.amount || 0 })}
            td.text-center #{expense.taxRate || 0}%
            td.text-right.amount-cell
              if cgst > 0
                | #{moneyFormatter({ amount: cgst })}
              else
                | -
            td.text-right.amount-cell
              if sgst > 0
                | #{moneyFormatter({ amount: sgst })}
              else
                | -
            td.text-right.amount-cell
              if igst > 0
                | #{moneyFormatter({ amount: igst })}
              else
                | -
            td.text-right.amount-cell #{moneyFormatter({ amount: expense.totalAmount || expense.amount || 0 })}

        tr.total-row
          td(colspan="5", style="text-align:right") Totals:
          td.text-right #{moneyFormatter({ amount: totalBase })}
          td
          td.text-right #{moneyFormatter({ amount: totalCGST })}
          td.text-right #{moneyFormatter({ amount: totalSGST })}
          td.text-right #{moneyFormatter({ amount: totalIGST })}
          td.text-right #{moneyFormatter({ amount: totalGrand })}

    .footer-section
      | This document is system generated by #{settings.company_name}.
