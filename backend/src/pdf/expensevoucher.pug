doctype html
html
  head
    link(rel="shortcut icon" type="image/png" href="/images/icons/favicon.png")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    style.
      @page {
        size: A5 landscape;
        margin: 0;
      }
      body {
        width: 210mm;
        margin: 0;
        padding: 0;
        background: #ffffff;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 10pt;
        color: #000;
        box-sizing: border-box;
      }
      .container {
        width: 100%;
        height: 138mm;
        padding: 10pt 20pt;
        position: relative;
        box-sizing: border-box;
        overflow: hidden;
      }
      .brand-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 2pt;
      }
      .logo-box {
        width: 80pt;
      }
      .logo-img {
        width: 100%;
        height: auto;
      }
      .company-title {
        text-align: center;
        flex-grow: 1;
      }
      .company-title h1 {
        margin: 0;
        color: #f7941d;
        font-size: 22pt;
        text-transform: uppercase;
      }
      .company-title p {
        margin: 2pt 0;
        font-size: 8pt;
        color: #666;
      }
      
      .voucher-title-row {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        margin-top: 2pt;
      }
      .voucher-label {
        color: #f7941d;
        font-size: 24pt;
        font-weight: bold;
        text-transform: uppercase;
      }
      .meta-table {
        border-collapse: collapse;
        width: 200pt;
      }
      .meta-table td {
        border: 1.5pt solid #f7941d;
        padding: 4pt 8pt;
        font-size: 9pt;
      }
      .meta-label {
        width: 40pt;
        font-weight: bold;
      }

      .main-form {
        margin-top: 6pt;
        width: 100%;
        border: 1.5pt solid #f7941d;
        border-collapse: collapse;
      }
      .main-form td {
        border: 1pt solid #f7941d;
        padding: 4pt 10pt;
        vertical-align: middle;
      }
      .field-row {
        display: flex;
        align-items: baseline;
      }
      .field-label {
        font-weight: bold;
        min-width: 60pt;
      }
      .field-value {
        flex-grow: 1;
        font-weight: 500;
      }

      .rupees-row {
        background-color: #f9f9f9;
      }

      .footer-grid {
        margin-top: 6pt;
        width: 100%;
        border: 1pt solid #f7941d;
        border-collapse: collapse;
      }
      .footer-grid td {
        border: 1pt solid #f7941d;
        padding: 3pt 10pt;
        font-size: 9pt;
      }
      .sig-box {
        height: 60pt;
        vertical-align: bottom !important;
        text-align: center;
        width: 30%;
      }
      .checkbox {
        display: inline-block;
        width: 10pt;
        height: 10pt;
        border: 1pt solid #000;
        margin: 0 3pt;
        vertical-align: middle;
        position: relative;
      }
      .checkbox.checked::after {
        content: 'âœ“';
        position: absolute;
        top: -4pt;
        left: 0pt;
        font-size: 10pt;
      }

  body
    .container
      .brand-header
        .logo-box
          if logo
            img.logo-img(src=logo)
          else
            div(style="font-weight:bold; color:#f7941d; font-size:18pt") #{settings.construction_company_name || 'BEST CONSTRUCTIONS'}
        .company-title
          h1 #{settings.construction_company_name || 'BEST CONSTRUCTIONS'}
          p #{settings.construction_address || 'Tamil Nadu, India'}
          if settings.construction_gstin
            p GSTIN: #{settings.construction_gstin}
          p Cell: #{settings.company_phone || '99524 52139, 73391 11784'}
      
      .voucher-title-row
        .voucher-label CASH VOUCHER
        table.meta-table
          tr
            td.meta-label No.
            td #{model.number || '-'}
          tr
            td.meta-label Date:
            td #{model.date ? moment(model.date).format(dateFormat) : '-'}
          tr
            td.meta-label Rs.
            td(style="font-weight:bold; font-size:11pt") #{moneyFormatter({amount: model.totalAmount || model.amount || 0})}

      table.main-form
        tr
          td(colspan="3")
            .field-row
              .field-label Paid to
              .field-value
                if model.recipientType === 'Labour' && model.labour
                  | #{model.labour.name}
                else if model.recipientType === 'Supplier' && model.supplier
                  | #{model.supplier.name}
                else
                  | #{model.description || 'N/A'}
        tr
          td(colspan="3")
            .field-row
              .field-label Debit
              .field-value(style="text-transform: uppercase; letter-spacing: 1px;") #{(model.recipientType || 'EXPENSE')} ACCOUNT
        - 
          let penalty = model.penalty || 0;
          let advance = model.advance || 0;
          let hasDeductions = penalty > 0 || advance > 0;
          let taxAmount = model.taxAmount || 0;
          let total = model.totalAmount || model.amount || 0;
          let amount = model.amount || 0;
          
        if hasDeductions || taxAmount > 0
          tr(style="height: 30pt")
            td(style="width: 70%; vertical-align: top;")
              .field-label Particulars:
              div(style="margin-top: 5pt; padding-left: 20pt;") #{model.description || '-'}
            td(style="width: 15%; text-align: center; font-weight: bold; border-bottom: none") 
            td(style="width: 15%; text-align: center; font-weight: bold; border-bottom: none") 
          
          tr
            td(style="text-align: right; padding-right: 10pt;") Amount
            td(style="text-align: center;") #{moneyFormatter({amount: amount})}
            td(style="text-align: center;")

          if taxAmount > 0
            tr
              td(style="text-align: right; padding-right: 10pt; font-style: italic") Add: #{model.taxType || 'GST'}
              td(style="text-align: center;") #{moneyFormatter({amount: taxAmount})}
              td(style="text-align: center;")

          if penalty > 0
            tr
              td(style="text-align: right; padding-right: 10pt; font-style: italic") Less: Penalty
              td(style="text-align: center;") #{moneyFormatter({amount: penalty})}
              td(style="text-align: center;")
          
          if advance > 0
            tr
              td(style="text-align: right; padding-right: 10pt; font-style: italic") Less: Advance Deduction
              td(style="text-align: center;") #{moneyFormatter({amount: advance})}
              td(style="text-align: center;")
          
          tr.rupees-row
            td(colspan="1")
              .field-row
                .field-label Rupees
                .field-value(style="font-style: italic;") #{model.inWords || '-'} Only
            td(colspan="2" style="background: #f0f0f0; text-align: center; font-weight: bold;")
              div(style="display: flex; justify-content: space-around;")
                span Total
                span #{moneyFormatter({amount: total})}

        else
          tr(style="height: 60pt")
            td(style="width: 70%; vertical-align: top;")
              .field-label Particulars:
              div(style="margin-top: 5pt; padding-left: 20pt;") #{model.description || '-'}
            td(style="width: 15%; text-align: center; font-weight: bold;") 
              div(style="border-bottom: 1px solid #f7941d; margin-bottom: 5pt; padding-bottom: 2pt") Rs.
              div #{total ? Math.floor(total).toLocaleString('en-IN') : '0'}
            td(style="width: 15%; text-align: center; font-weight: bold;") 
              div(style="border-bottom: 1px solid #f7941d; margin-bottom: 5pt; padding-bottom: 2pt") P.
              div 00
          tr.rupees-row
            td(colspan="1")
              .field-row
                .field-label Rupees
                .field-value(style="font-style: italic;") #{model.inWords || '-'} Only
            td(colspan="2" style="background: #f0f0f0; text-align: center; font-weight: bold;")
              div(style="display: flex; justify-content: space-around;")
                span Total
                span #{moneyFormatter({amount: total})}

      table.footer-grid
        tr
          td(style="width: 35%")
            div(style="margin-bottom: 2pt") Authorised by:
            div(style="height: 15pt")
            div(style="border-top: 1px solid #000; padding-top: 2pt") Passed by:
          td(rowspan="2").sig-box
            div(style="border-top: 1px solid #000; width: 80%; margin: 0 auto 3pt;")
            | Receiver's Signature
          td(rowspan="2" style="width: 35%; vertical-align: top;")
            .payment-info(style="font-size: 8pt")
              div Paid by 
                b(style="text-transform:uppercase; margin-left: 5pt;") #{model.paymentMode || 'Cash'}
                |  / Cheque drawn on 
              div(style="margin-top: 4pt") Cheque No. ....................................................
              div(style="margin-top: 4pt") Date. .............................................................



